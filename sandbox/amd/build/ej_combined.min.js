/**
 * Ejercicio 4: Combinando core/ajax + core/templates + core/notification
 *
 * Este es el PATRÓN REAL de desarrollo Moodle:
 * 1. El usuario interactúa con la página
 * 2. JS llama a un Web Service vía core/ajax
 * 3. La respuesta se renderiza con core/templates
 * 4. Se muestra una notificación con core/notification
 *
 * @module     local_sandbox/ej_combined
 * @copyright  2026 Tu Nombre
 * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
 */
define("local_sandbox/ej_combined",["core/ajax","core/templates","core/notification"],(function(Ajax,Templates,Notification){var callCount=0;function toggleLoading(show){document.getElementById("combined-loading").style.display=show?"block":"none"}function addToHistory(name,timeofday,success){callCount++;var list=document.getElementById("history-list"),li=document.createElement("li");li.className="list-group-item list-group-item-"+(success?"success":"danger"),li.textContent="#"+callCount+" — "+name+" ("+timeofday+") — "+(success?"OK":"ERROR")+" — "+(new Date).toLocaleTimeString(),list.insertBefore(li,list.firstChild)}return{init:function(){document.getElementById("btn-combined").addEventListener("click",(function(){var name=document.getElementById("combined-name").value.trim(),timeofday=document.getElementById("combined-time").value;name?function(name,timeofday){toggleLoading(!0),document.getElementById("combined-output").innerHTML="",Ajax.call([{methodname:"local_sandbox_get_greeting",args:{name:name,timeofday:timeofday}}])[0].then((function(response){var context={name:name,greeting:response.greeting,timestamp:response.timestamp,cssclass:{morning:"border-warning",afternoon:"border-success",evening:"border-primary"}[timeofday]||"border-secondary"};return Templates.renderForPromise("local_sandbox/greeting_card",context)})).then((function(result){return toggleLoading(!1),document.getElementById("combined-output").innerHTML=result.html,Templates.runTemplateJS(result.js),Notification.addNotification({message:"Greeting generated successfully for "+name+"!",type:"success"}),addToHistory(name,timeofday,!0),result})).catch((function(error){toggleLoading(!1),Notification.addNotification({message:"Failed to generate greeting: "+error.message,type:"error"}),addToHistory(name,timeofday,!1),Notification.exception(error)}))}(name,timeofday):Notification.addNotification({message:"Please enter a name.",type:"warning"})})),window.console.log("[ej_combined] Módulo inicializado correctamente.")}}}));

//# sourceMappingURL=ej_combined.min.js.map